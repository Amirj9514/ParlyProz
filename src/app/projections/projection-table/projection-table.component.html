<div class="tableStyle">
  <p-table
    [value]="projectionData"
    [scrollable]="true"
    scrollHeight="calc(100vh - 272px)"
    stripedRows
    [tableStyle]="{ 'min-width': '50rem' }"
    (sortFunction)="customSort($event)" [customSort]="true"
  >
    <ng-template #header>
      <tr>
        @for (col of tableColumns; track $index) {
        <th
        [pSortableColumn]="col?.sortFeild"
          class="cursor-pointer text-sm"
          [ngClass]="$index > 1 ? ' text-center' : ''"
          [pTooltip]="col.toolTip"
          [tooltipPosition]="col.toolTipPosition"
        >
          {{ col.header }}
          @if (col?.sortFeild) {
            <p-sortIcon [field]="col.sortFeild"></p-sortIcon>
          }
        </th>
        }
      </tr>
    </ng-template>
    <ng-template #body let-player>
      @if (projectionLoader) {
      <tr>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
        <td><p-skeleton /></td>
      </tr>
      }@else {
      <tr>
        <td>
          <div class="flex gap-2 align-items-center">
            <div class="statIcon font-semibold primaryTextClr">
              {{ getInitials(player.first_name + " " + player.last_name) }}
            </div>
            <div
              class="playerDetail cursor-pointer"
              (click)="redirectToPlayerDetail(player)"
            >
              <div class="flex align-items-center gap-2 playerName">
                <div class="text-sm font-semibold">
                  {{ player.first_name + " " + player.last_name }} ({{
                    player.position
                  }})
                </div>
              </div>
              <div class="place lightClr text-xs">
                {{ capatlizeStats(player?.field) }}
              </div>
            </div>
          </div>
        </td>
        <td class="text-sm">{{ player?.line }}</td>
        <td
          class="text-center text-sm"
          [ngClass]="
            returnSeverity(player?.average_last_10, 'avgLast10', player?.line)
          "
        >
          {{ roundValue(player?.average_last_10) }}
        </td>
        <td
          class="text-center text-sm"
          [ngClass]="returnSeverity(player?.average_last_10_line_diff, 'diff')"
        >
          {{ roundValue(player?.average_last_10_line_diff) }}
        </td>

        <td
          class="text-center text-sm"
          [ngClass]="returnSeverity(player?.last_5_over_line_percentage, '')"
        >
          {{ roundValue(player?.last_5_over_line_percentage) + " %" }}
        </td>

        <td
          class="text-center text-sm"
          [ngClass]="returnSeverity(player?.last_10_over_line_percentage, '')"
        >
          {{ roundValue(player?.last_10_over_line_percentage) + " %" }}
        </td>

        <td
          class="text-center text-sm"
          [ngClass]="returnSeverity(player?.last_15_over_line_percentage, '')"
        >
          {{ roundValue(player?.last_15_over_line_percentage) + " %" }}
        </td>
        <td
          class="text-center text-sm"
          [ngClass]="returnSeverity(player?.streak, 'streak')"
        >
          {{ player?.streak }}
        </td>
      </tr>
      }
    </ng-template>
    <ng-template #emptymessage>
      <tr>
        <td colspan="8" class="text-center">
          <div class="emptyMessage">
            <h2>No Data Found...</h2>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <div class="card flex justify-content-center">
    <p-paginator
      [showCurrentPageReport]="true"
      currentPageReportTemplate="Showing {first} to {last}"
      (onPageChange)="onPageChange($event)"
      [first]="first"
      [rows]="rows"
      [totalRecords]="totalRecords"
      [rowsPerPageOptions]="[10, 20, 30]"
    />
  </div>
</div>
